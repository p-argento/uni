## How to classify Time Series
Generally assume that all ts have the same length m.
The goal is to find a function f that maps from the space of all ts to the space of class values. So, given a set X of n time series, each ts has m values and a class value c.

There are 2 main methods
1. KNN Classification
2. Shapelet-based Classification

# 1. KNN Classification
It is the most widely used and effective approach for time series classification (TSC).
It consists in using KNN on the raw ts.
DTW gives much better results than the ED.
However, it is very slow to calculate, given also the "lazyness" of the classifier.


# 2. Shapelet-based Classification
It is a better alternative compared to traditional KNN.
A shapelet is a subsequence of a predefined length n, such that the shape is characterizing one of the classes. So, a shapelet is a representative subsequence of the vector of distances that compose the ts.

## Shapelet Tranformer and Shapelet Dataset
The shapelets are used to transform a ts dataset and to use the transformed version as input for training a ml classifiers.
In other words, a ts dataset is used to obtain a shapelet dataset that will train ML model.

How to obtain the shapelet dataset? Using a "shapelet transformer", after the identification of shapelets.
The shapelet transformer calculates the distance between the ts and the shapelets.

The "shapelet dataset" is generated by the shapelet transformer. Observe that the temporal information is not present anymore. This dataset will have a different dimension NxK, given the K shapelets found. It will have a highly discriminative power because, by design, this features are highly discriminative. It is tailored for ML classifiers.
Then, a ML classifer, for example a Decision Tree, will ask something like "does ts1 have a subsequence s within a distance of x of shape y?"

![[Pasted image 20240324185228 1.png]]

## Distance with a subsequence
In the shapelet transformer, this is very important because we are computing the distance between a very small object (shapelet S) and a big one (ts T).
We use a distance function that computes the minimum distance between the shapelet and a subsequence of the ts, meaning that it looks for the best matching location for S in the ts to compute the distance.
It will something like $SubsequenceDist(T,S)=min(Dist(S,S'))$ where S' is in the set of all possible subsequences of T.

![[Pasted image 20240420183245.png]]

## Shapelet Extraction
To use the shapelet transformer, first we need to extract the shapelets from the ts dataset.

Shapelets are ts subsequences maximally representative of a class.
They can provide interpretable results, which is really interesting for example in finance or medicine because it helps domain practitioners better understand their data.

Observe that while other ts classifiers consider global features, the shapelets are local features.

There are many different ways to extract shapelets.
1. random, defined the length (works surprisingly well)
2. brute-force
3. gradient-based
4. genetic
5. etc

### Brute-Force extraction
We create a candidate pool of shapelets, extracting all the subsequences of all possible lengths.
Then we need to test the utility of a candidate shapelet, in order to select the ones that are really representative.
We look for the shapelet that achieve the maximum information gain, similar to decision trees.

In particular, we arrange the TSs dataset based on the distance from the candidate. Then, we find the optimal split point that maximizes the information gain. 

![[Pasted image 20240420190637.png]]

For example, given 2 classes where we compute the gain using the entropy.
![[Pasted image 20240420191614.png]]
![[Pasted image 20240420191636.png]]





### Gradient-based extraction



## Motif vs Shapelet
DO NOT confuse motifs/discords with shapelets.
They are different.

A motif is a repeated pattern (also subsequence) in ONE given TS.
It is extracted in a unsupervised way.

A shapelet is a pattern (also subsequence) which is maximally representative of a class with respect to a given dataset of TSs. It is extracted for a supervised task on a dataset.

Observe that motifs can be used as shapelets, because they are subsequences, but probably discords are much better shapelets since they characterize the sequence with respect to others.




